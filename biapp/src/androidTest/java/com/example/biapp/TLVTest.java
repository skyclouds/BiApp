package com.example.biapp;

import androidx.test.ext.junit.runners.AndroidJUnit4;

import com.biapp.utils.GsonUtil;
import com.biapp.utils.PrintfUtil;
import com.biapp.utils.TLVUtil;

import org.junit.Test;
import org.junit.runner.RunWith;

import java.util.List;

import aura.data.Bytes;

@RunWith(AndroidJUnit4.class)
public class TLVTest {

    private static String KDH_ENC = "3082042130820209A003020102020160300D06092A864886F70D010105050030333111300F060355040A0C08496E67656E69636F311E301C06035504030C15546573742056332053657276657220537562204341301E170D3138303430393133313035335A170D3238303430383133313035335A30163114301206035504030C0B4B65794D61737320456E6330820122300D06092A864886F70D01010105000382010F003082010A0282010100C4F40B6B2CDE7ACD9FBDD12E444377FDE40F3320C35740471890EC8F7FA2DFEC7E6BFC91E862FD3C5EB9233CBDB72A69B194ABBC8A0C006AC27CB5E35611383DCCCA0439B51AA6169C3A8A7AB69C79B0A75E35B14E567A79FEAAB3F2EDB1F0ED425A073D3E310C66E7FEB5A49113FD8691A8F4560D18E81177D57203BE2C23995E1EED52E4F74613A1610313BE57698C81AB215C5F76FBC5C08F64832B54077CF30FB899B925A9EF596D2183271EF21304937F8840751CD534B135BFA39884B6D9C0B53A6688217EBE89418D7DC1FE5F7B53D19C1852F37CB573B19C7206ECD3962CF1DE8D381592B8186B5EBCF4F5C9FFBFF7B22355E71B165D12EAFB9CBFA10203010001A35D305B300C0603551D130101FF04023000301D0603551D0E041604143293F7BD62F54C39857229ED1B0CE561537770B4301F0603551D230418301680146F375386657D48097180D585255EC0A125375CA7300B0603551D0F040403020520300D06092A864886F70D01010505000382020100C3286A9B269DA6899A049CC7F4C614595EA4C955D3975B545737ACF77E58950D16589A356C783150A2ADD18E4B79C646D1AB54175239B7247FDC7B756682810A4916C390FEBB7C1A5DFCD89E684AEE3F96B6D5C105E244F7C0E5307886B6370F29A6E62172382861C99E7D1F034367A0575A3EA9FD25BBAE1DE284817F85150F986E4A0F7EB6D6D66CA4EC7F413F45D23ADC00EECE42631D2F1B61A86FAE66253CD417F68562ECE395A8BE47D33E556258E688EAA96CA6340DC8D14E2712171B126E6A7D00D152E7B364791EDDB0D1280CF6DA8BFC9AFAB78D264A01F6054A0258381E68308F83FF63FD5432A128009D492F2961B04E855DDCA283C9E19396A5EAA0D79CF25264715F4929FB48638AA65266181739D51F88E90C63BF9EA0DEFAEFD024705E323B38004D881897F617CB3452DEA2D195EB469D272976643142BA22A1ED51B3F7EEC5523A5F3BC0F1F8BE83B03D76926DE0E31FE03ADB0F2B95F1E21C6DC2353F4B6667E4CDADDA306436AA97DE2037755EA1B9438B86CF9005339F2F7AFE09962ABB991EA82367479FAD886446E4296634869B078F7C3D2C218A5EC2C41DD15FDEDC9DE60CFD2D3A680C7E9BDC6A98AAFF32BC714E505149EBC7FE635B6A5C7B1A61C260835F12FEA80994D35BE60ABF2B3A175D2491BFB8957E96576C1FB8E123121B80E647C2B1EA2FB4F87DC69D1CDCC52DE1A03FDB5FDBF7";
    public static String PKCS1_PUBLIC_KEY = "3082010A0282010100BCDDE53C4254AFBBDF3E196A8C8D0507F02AB8B25EB81FEEACD21966F6016A9F9B36EA0BE71E623C4E14A5719139971C1CC691FE132E0E6E466164ECA0ACB9517CDFEB752473FE81BF9C1A61A67FE309C00A5855409348B78F348E38198CB8F188C68C772E3F3699E4920CD780D09638F1334757EE9C4463799DBEBE2DFB9649EA2C74C53B2C9974DC28AA18C2408351B9A0C4CD95D8E6A40E4589DF59A230763C3CE80955F2F3E8E572B049E50A3F205B4F8D572E0EBB03B2ED17B8DF547962AA9C818209FE261B5631C930A7DD294AC35367793505EF5692420EB0D1FDD92E7C62101A8DA3ADE1D7C1F33985027366AEA708AED770EA58FFBD55CC0159108F0203010001";

    @Test
    public void test() {
        List<TLVUtil.TLV> tlvs = TLVUtil.parseDER(Bytes.fromHexString(KDH_ENC));
        PrintfUtil.d("KDH_ENC", GsonUtil.toJson(tlvs));
        tlvs = TLVUtil.parseDER(Bytes.fromHexString(PKCS1_PUBLIC_KEY));
        PrintfUtil.d("PKCS1_PUBLIC_KEY", GsonUtil.toJson(tlvs));
    }
}
